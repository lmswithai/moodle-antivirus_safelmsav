{"version":3,"file":"displaytermsofservice.min.js","sources":["../src/displaytermsofservice.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Dynamic forms termsofservice.\n *\n * @module     antivirus_safelmsav\n * @copyright  2024, when2update.com <consultations@when2update.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport ModalForm from 'core_form/modalform';\nimport {acceptTermsOfService} from './repository';\nimport {get_string as getString} from 'core/str';\n\nexport const termsofserviceform = async() => {\n\n    const openTermsButton = document.querySelector('[data-action=opentermsofservice]');\n\n    if (openTermsButton) {\n\n        document.querySelector('[data-action=opentermsofservice]').addEventListener('click', async(e) => {\n\n            const button = e.currentTarget;\n\n            const response = await acceptTermsOfService();\n\n            if (response.accepttermsofservice) {\n                return;\n            } else {\n                button.disabled = true;\n                e.preventDefault();\n                const form = new ModalForm({\n                    formClass: '\\\\antivirus_safelmsav\\\\termsofserviceform',\n                    modalConfig: {\n                        title: getString('titletermsofservice', 'antivirus_safelmsav'),\n                    },\n                    returnFocus: e.currentTarget\n                });\n                form.show();\n\n                form.addEventListener(form.events.LOADED, () => {\n                    button.disabled = false;\n                });\n\n\n            }\n\n        });\n    }\n\n};"],"names":["async","document","querySelector","addEventListener","button","e","currentTarget","accepttermsofservice","disabled","preventDefault","form","ModalForm","formClass","modalConfig","title","returnFocus","show","events","LOADED"],"mappings":";;;;;;;0LA2BkCA,UAENC,SAASC,cAAc,qCAI3CD,SAASC,cAAc,oCAAoCC,iBAAiB,SAASH,MAAAA,UAE3EI,OAASC,EAAEC,yBAEM,uCAEVC,qBAEN,CACHH,OAAOI,UAAW,EAClBH,EAAEI,uBACIC,KAAO,IAAIC,mBAAU,CACvBC,UAAW,4CACXC,YAAa,CACTC,OAAO,mBAAU,sBAAuB,wBAE5CC,YAAaV,EAAEC,gBAEnBI,KAAKM,OAELN,KAAKP,iBAAiBO,KAAKO,OAAOC,QAAQ,KACtCd,OAAOI,UAAW"}